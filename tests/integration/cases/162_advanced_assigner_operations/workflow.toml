# Advanced: Variable assigner with append and overwrite operations.
# File: Workflow DSL definition

version = "0.1.0"
[[nodes]]
id = "start"

[nodes.data]
type = "start"
title = "Start"
[[nodes.data.variables]]
variable = "base"
label = "Base"
type = "array[string]"
required = true

[[nodes]]
id = "assign1"

[nodes.data]
type = "variable-assigner"
title = "Append Items"

[[nodes.data.assignments]]
variable = "list"
value_selector = [ "start", "base",]
write_mode = "overwrite"

[[nodes.data.assignments]]
variable = "list"
value = ["extra1", "extra2"]
write_mode = "append"

[[nodes]]
id = "code1"

[nodes.data]
type = "code"
title = "Process"
code = "function main(inputs) { return { count: inputs.list.length }; }"
language = "javascript"
[[nodes.data.variables]]
variable = "list"
value_selector = [ "assign1", "list",]

[[nodes]]
id = "assign2"

[nodes.data]
type = "variable-assigner"
title = "Add Count"

[[nodes.data.assignments]]
variable = "result"
value_selector = [ "code1", "count",]
write_mode = "overwrite"

[[nodes]]
id = "end"

[nodes.data]
type = "end"
title = "End"
[[nodes.data.outputs]]
variable = "result"
value_selector = [ "assign2", "result",]

[[edges]]
source = "start"
target = "assign1"

[[edges]]
source = "assign1"
target = "code1"

[[edges]]
source = "code1"
target = "assign2"

[[edges]]
source = "assign2"
target = "end"
