# HTTP if-else status: branches based on HTTP response status code.
# File: Workflow DSL definition

version = "0.1.0"
[[nodes]]
id = "start"

[nodes.data]
type = "start"
title = "Start"
variables = []
[[nodes]]
id = "http1"

[nodes.data]
type = "http-request"
title = "Fetch API"
method = "GET"
url = "{{#sys.base_url#}}/api/check"
timeout = 10
[[nodes]]
id = "if1"

[nodes.data]
type = "if-else"
title = "Check Status"
[[nodes.data.cases]]
case_id = "success"
logical_operator = "and"
[[nodes.data.cases.conditions]]
variable_selector = [ "http1", "status_code",]
comparison_operator = "equal"
value = 200


[[nodes]]
id = "end_ok"

[nodes.data]
type = "answer"
title = "OK"
answer = "API returned OK"
[[nodes]]
id = "end_fail"

[nodes.data]
type = "answer"
title = "Fail"
answer = "API returned error"
[[nodes]]
id = "end"

[nodes.data]
type = "end"
title = "End"
[[nodes.data.outputs]]
variable = "status_code"
value_selector = [ "http1", "status_code",]

[[edges]]
source = "start"
target = "http1"

[[edges]]
source = "http1"
target = "if1"

[[edges]]
source = "if1"
target = "end_ok"
sourceHandle = "success"

[[edges]]
source = "if1"
target = "end_fail"
sourceHandle = "false"

[[edges]]
source = "end_ok"
target = "end"

[[edges]]
source = "end_fail"
target = "end"

