# Error strategy fail branch: node failure routes to a designated error branch.
# File: Workflow DSL definition

version = "0.1.0"
[[nodes]]
id = "start"

[nodes.data]
type = "start"
title = "Start"
[[nodes]]
id = "risky_code"

[nodes.data]
type = "code"
title = "Risky Code"
code = "function main(inputs) { throw new Error('intentional failure'); }"
language = "javascript"
[nodes.data.error_strategy]
type = "fail-branch"
[[nodes]]
id = "success_tmpl"

[nodes.data]
type = "template-transform"
title = "Success Path"
template = "success"
[[nodes]]
id = "failure_tmpl"

[nodes.data]
type = "template-transform"
title = "Failure Path"
template = "caught-error"
[[nodes]]
id = "end_success"

[nodes.data]
type = "end"
title = "End Success"
[[nodes.data.outputs]]
variable = "result"
value_selector = [ "success_tmpl", "output",]

[[nodes]]
id = "end_failure"

[nodes.data]
type = "end"
title = "End Failure"
[[nodes.data.outputs]]
variable = "result"
value_selector = [ "failure_tmpl", "output",]

[[edges]]
source = "start"
target = "risky_code"

[[edges]]
source = "risky_code"
target = "success_tmpl"
sourceHandle = "source"

[[edges]]
source = "risky_code"
target = "failure_tmpl"
sourceHandle = "fail-branch"

[[edges]]
source = "success_tmpl"
target = "end_success"

[[edges]]
source = "failure_tmpl"
target = "end_failure"

